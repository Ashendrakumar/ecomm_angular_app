<div class="card h-100 border-0 shadow-sm product-card">
  <a [routerLink]="['/products', product.id]" class="text-decoration-none h-100 d-flex flex-column">
    <!-- Image Container -->
    <div class="position-relative overflow-hidden image-container">
      <img
        [src]="product.images[0] || 'https://placehold.co/400x400/png?text=No+Image'"
        [alt]="product.name"
        class="card-img-top"
        loading="lazy"
      />

      <!-- Badges -->
      <div class="position-absolute top-0 start-0 p-2 d-flex flex-column gap-1">
        @if (!product.inStock) {
          <span class="badge bg-danger rounded-2 shadow-sm">Out of Stock</span>
        }
        @if (discountPercentage > 0) {
          <span class="badge bg-primary rounded-2 shadow-sm">-{{ discountPercentage }}%</span>
        }
      </div>

      <!-- Add to Cart  -->
      @if (product.inStock) {
        <button
          class="btn btn-primary w-100 position-absolute bottom-0 start-0 rounded-0"
          (click)="addToCart($event)"
          [disabled]="isAdding()"
        >
          @if (isAdding()) {
            <span
              class="spinner-border spinner-border-sm me-1"
              role="status"
              aria-hidden="true"
            ></span>
            Adding...
          } @else {
            <i class="bi bi-cart-plus me-1"></i> Add to Cart
          }
        </button>
      }
    </div>

    <!-- Content -->
    <div class="card-body d-flex flex-column p-3">
      <h5 class="card-title fw-bold">{{ product.name }}</h5>
      <div class="text-muted small text-uppercase fw-semibold mb-auto brand-text">
        {{ product.brand }}
      </div>
      <div class="mt-3 d-flex justify-content-between align-items-end">
        <div class="d-flex flex-column">
          @if (product.originalPrice && product.originalPrice > product.price) {
            <span class="text-muted text-decoration-line-through small">
              ${{ getOriginalPriceFormatted() }}
            </span>
          }
          <span class="h5 mb-0 fw-bold text-gold">${{ getPriceFormatted() }}</span>
        </div>
      </div>
    </div>
  </a>
</div>
